#include "utility.h"
#include "data_structures.h"
#include "data_io.h"
#include "d8_methods.h"
#include "dinf_methods.h"
#include "pit_fill.h"
#include "interface.h"

int main(int argc, char **argv){
	float_2d elevations,elevations2,elevations3,elevations4;
	uint_2d area;
	try{
		load_ascii_data(argv[1],elevations);
		elevations2=elevations;
		elevations3=elevations;
		elevations4=elevations;

//		printf("====Original====\n");
//		print_dem(elevations,0,0);

		printf("\n====Wang 1====\n");
		pit_fill_wang(elevations);
		printf("\n====Wang 2====\n");
		pit_fill_wang(elevations);
		printf("\n====Barnes 1====\n");
		pit_fill_barnes1(elevations2);
//		printf("\n====Barnes 2====\n");
//		pit_fill_barnes2(elevations3);
		printf("\n====Barnes 3====\n");
		pit_fill_barnes3(elevations4);
/*
		printf("\n====Wang====\n");
		print_dem(elevations2,0,0);
		printf("\n====Barnes====\n");
		print_dem(elevations,0,0);
*/
		bool good=true;
		for(int x=0;x<elevations.width();x++)
		for(int y=0;y<elevations.height();y++)
			if(elevations(x,y)!=elevations2(x,y)){
				good=false;
				break;
			}
		printf("%d\n",good);
/*
		good=true;
		for(int x=0;x<elevations.width();x++)
		for(int y=0;y<elevations.height();y++)
			if(elevations(x,y)!=elevations3(x,y)){
				good=false;
				break;
			}
		printf("%d\n",good);
*/
		good=true;
		for(int x=0;x<elevations.width();x++)
		for(int y=0;y<elevations.height();y++)
			if(elevations(x,y)!=elevations4(x,y)){
				good=false;
				break;
			}
		printf("%d\n",good);

//		char_2d flowdirs(elevations);

	//	pit_fill_yonghe2009(elevations);
	//	pit_fill_wang(elevations);
//	dinf_flow_directions(elevations,flowdirs);
	//	dinf_upslope_area(flowdirs);

//		d8_flow_directions(elevations,flowdirs);

//		uint_2d area(elevations);
//		print_flow(flowdirs);
//		d8_upslope_area(flowdirs,area);
		return 0;
	} catch (int e) {
		diagnostic("Unfortunately, I was unable to continue.\nClosing...\n");
		return -1;
	}
}
